import tensorflow as tf
import numpy as np

X = np.random.randn(2, 10, 8)
# The second example is of length 6
X[1, 6:] = 0
X_lengths = [10, 6]

cell = tf.nn.rnn_cell.LSTMCell(num_units=5, state_is_tuple=True)  # 通过基本的LSTM网络来构建。

outputs, states = tf.nn.bidirectional_dynamic_rnn(cell_fw=cell, cell_bw=cell, dtype=tf.float64, sequence_length=X_lengths, inputs=X)

output_fw, output_bw = outputs
states_fw, states_bw = states

with tf.Session() as sess:
    sess.run(tf.global_variables_initializer())
    states_shape = tf.shape(states)
    print(states_shape.eval())
    c, h = states_fw
    o = output_fw
    print('c\n', sess.run(c))
    print('h\n', sess.run(h))
    print('o\n', sess.run(o))


# 输出向量：
"""
c
 [[ 0.1204829   0.58737896 -0.17930821 -0.27514693  0.17554669]
 [ 0.29311234 -0.35460602 -0.08141876  0.15802849 -0.19384982]]
h
 [[ 0.03990309  0.14300029 -0.13898347 -0.17501692  0.05763551]
 [ 0.1481191  -0.19092087 -0.02303319  0.0970913  -0.1321687 ]]
o
 [[[-0.13902779 -0.07214505  0.02914405  0.04089066 -0.03514866]
  [-0.25160376 -0.04728888  0.01961744 -0.00850906 -0.00248225]
  [-0.04727771 -0.00665457  0.005105    0.05882545 -0.10276742]
  [-0.08925764  0.05739427 -0.31128908 -0.10326603  0.07647327]
  [-0.26888099 -0.0307524  -0.01957451 -0.12949508  0.39629787]
  [-0.37324534  0.0157041  -0.02145313 -0.11918801  0.23110909]
  [-0.37294099 -0.00058506 -0.06209187 -0.05072166  0.21251325]
  [-0.39312673  0.05362095 -0.11148292 -0.15970644  0.26925744]
  [-0.3726428  -0.02345857 -0.0599908   0.01188544  0.27778909]
  [ 0.03990309  0.14300029 -0.13898347 -0.17501692  0.05763551]]

 [[-0.2487504   0.05820684 -0.00504286 -0.04590857  0.36892604]
  [-0.13207878 -0.04802762  0.21448604  0.29528022  0.30016216]
  [-0.06222772 -0.24266181  0.16036322  0.16083379  0.18370354]
  [-0.16318186 -0.32829888  0.05770835  0.17460485  0.0897061 ]
  [-0.06213706 -0.21672611 -0.01428671  0.02728159 -0.02328458]
  [ 0.1481191  -0.19092087 -0.02303319  0.0970913  -0.1321687 ]
  [ 0.          0.          0.          0.          0.        ]
  [ 0.          0.          0.          0.          0.        ]
  [ 0.          0.          0.          0.          0.        ]
  [ 0.          0.          0.          0.          0.        ]]]



"""